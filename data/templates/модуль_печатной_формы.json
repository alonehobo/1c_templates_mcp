{
  "id": "модуль_печатной_формы",
  "name": "Модуль печатной формы",
  "description": "Шаблон модуля объекта с функцией ПечатьДокументов для внешней печатной формы",
  "tags": [
    "печать",
    "форма",
    "макет",
    "внешняя"
  ],
  "code": "// Шаблон внешней печатной формы\n// Подключается через регистр сведений \"ВнешниеОбработки\" или напрямую\n\nПерем ИмяФормы;\n\nФункция СведенияОВнешнейОбработке() Экспорт\n\n    ПараметрыРегистрации = НовыйПараметрыРегистрации();\n    ПараметрыРегистрации.Вид = \"ПечатнаяФорма\";\n    ПараметрыРегистрации.Наименование = \"Наименование печатной формы\";\n    ПараметрыРегистрации.БезопасныйРежим = Ложь;\n    ПараметрыРегистрации.Версия = \"1.0\";\n    ПараметрыРегистрации.Информация = \"Описание печатной формы\";\n\n    ДобавитьНазначение(ПараметрыРегистрации.Назначения, \"Документ.ИмяДокумента\");\n\n    Возврат ПараметрыРегистрации;\n\nКонецФункции\n\nФункция НовыйПараметрыРегистрации()\n\n    ПараметрыРегистрации = Новый Структура;\n    ПараметрыРегистрации.Вставить(\"Вид\",               \"\");\n    ПараметрыРегистрации.Вставить(\"Наименование\",      \"\");\n    ПараметрыРегистрации.Вставить(\"БезопасныйРежим\",   Истина);\n    ПараметрыРегистрации.Вставить(\"Версия\",            \"\");\n    ПараметрыРегистрации.Вставить(\"Информация\",        \"\");\n    ПараметрыРегистрации.Вставить(\"Назначения\",        НовыйМассивНазначений());\n    Возврат ПараметрыРегистрации;\n\nКонецФункции\n\nФункция НовыйМассивНазначений()\n    Возврат Новый Массив;\nКонецФункции\n\nПроцедура ДобавитьНазначение(Назначения, ИмяМетаданных)\n    Назначение = Новый Структура(\"ИмяМетаданных\", ИмяМетаданных);\n    Назначения.Добавить(Назначение);\nКонецПроцедуры\n\n// ---------------------------------------------------------------------------\n// Основная точка входа — вызывается системой\n// ---------------------------------------------------------------------------\n\nПроцедура ПечатьДокументов(МассивОбъектов, КоллекцияПечатныхФорм, ИмяМакета, ДополнительныеПараметры) Экспорт\n\n    Для Каждого ИмяФормы Из МассивОбъектов Цикл\n\n        Если ПечатьКлиентСервер.НужноПечататьМакет(КоллекцияПечатныхФорм, ИмяМакета) Тогда\n\n            ТабличныйДокумент = СформироватьПечатнуюФорму(ИмяФормы);\n\n            ПечатьКлиентСервер.ВывестиТабличныйДокументВКоллекцию(\n                КоллекцияПечатныхФорм,\n                ИмяМакета,\n                \"Наименование печатной формы\",\n                ТабличныйДокумент);\n\n        КонецЕсли;\n\n    КонецЦикла;\n\nКонецПроцедуры\n\n// ---------------------------------------------------------------------------\n// Формирование табличного документа\n// ---------------------------------------------------------------------------\n\nФункция СформироватьПечатнуюФорму(Ссылка)\n\n    Макет = ПолучитьМакет(\"Макет\");\n\n    ТабличныйДокумент = Новый ТабличныйДокумент;\n    ТабличныйДокумент.ИмяПараметровПечати = \"ПАРАМЕТРЫ_ПЕЧАТИ_\" + ИмяФормы;\n\n    Шапка = Макет.ПолучитьОбласть(\"Шапка\");\n    ИтоговаяЧасть = Макет.ПолучитьОбласть(\"ИтоговаяЧасть\");\n    ОбластьСтрокиТабличнойЧасти = Макет.ПолучитьОбласть(\"СтрокаТабличнойЧасти\");\n\n    // --- Шапка ---\n    Объект = Ссылка.ПолучитьОбъект();\n\n    Шапка.Параметры.Организация     = Объект.Организация;\n    Шапка.Параметры.НомерДокумента  = Объект.Номер;\n    Шапка.Параметры.ДатаДокумента   = Объект.Дата;\n    ТабличныйДокумент.Вывести(Шапка);\n\n    // --- Табличная часть ---\n    Для Каждого СтрокаТЧ Из Объект.Товары Цикл\n        ОбластьСтрокиТабличнойЧасти.Параметры.Заполнить(СтрокаТЧ);\n        ТабличныйДокумент.Вывести(ОбластьСтрокиТабличнойЧасти);\n    КонецЦикла;\n\n    // --- Итог ---\n    ИтоговаяЧасть.Параметры.СуммаИтого = Объект.Товары.Итог(\"Сумма\");\n    ТабличныйДокумент.Вывести(ИтоговаяЧасть);\n\n    Возврат ТабличныйДокумент;\n\nКонецФункции\n"
}